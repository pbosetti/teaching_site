<!DOCTYPE html>
<html lang="it-IT"><head>
<script src="../../site_libs/cookie-consent/cookie-consent.js"></script>
<link href="../../site_libs/cookie-consent/cookie-consent.css" rel="stylesheet">
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-html/tabby.min.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/light-border.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-549806ee2085284f45b00abea8c6df48.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.6.40">

  <meta name="author" content="Paolo Bosetti">
  <title>Paolo Bosetti – Design of Experiments</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="../../site_libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="../../site_libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
  </style>
  <link rel="stylesheet" href="../../site_libs/revealjs/dist/theme/quarto-f5b10fc125ee2ba6c83f7620df646e3b.css">
  <script async="" src="https://www.googletagmanager.com/gtag/js?id=G-77EMP7T5YY"></script>

  <script type="text/plain" cookie-consent="tracking">

  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-77EMP7T5YY', { 'anonymize_ip': true});
  </script>
  
  <script type="text/javascript" charset="UTF-8">
  document.addEventListener('DOMContentLoaded', function () {
  cookieconsent.run({
    "notice_banner_type":"simple",
    "consent_type":"express",
    "palette":"light",
    "language":"en",
    "page_load_consent_levels":["strictly-necessary"],
    "notice_banner_reject_button_hide":false,
    "preferences_center_close_button_hide":false,
    "website_name":""
    ,
  "language":"it-IT"
    });
  });
  </script> 
    
  <link href="../../site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="../../site_libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="../../site_libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="../../site_libs/revealjs/plugin/reveal-chalkboard/font-awesome/css/all.css" rel="stylesheet">
  <link href="../../site_libs/revealjs/plugin/reveal-chalkboard/style.css" rel="stylesheet">
  <link href="../../site_libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" class="quarto-title-block center">
  <h1 class="title">Design of Experiments</h1>
  <p class="subtitle"></p><p>Analisi Dati e Statistica, 2024–25<br>
<img data-src="images/by-nc-sa.png" height="30"></p><p></p>

<div class="quarto-title-authors">
<div class="quarto-title-author">
<div class="quarto-title-author-name">
Paolo Bosetti 
</div>
        <p class="quarto-title-affiliation">
            Università di Trento, Dipartimento di Ingegneria Industriale
          </p>
    </div>
</div>

  <p class="date"><em>Ultimo aggiornamento:</em> 24/03/2025</p>
</section>
<section>
<section id="design-and-analysis-of-experiments" class="title-slide slide level1 center">
<h1>Design (and Analysis) of Experiments</h1>
<p><span class="math inline">\(\renewcommand{\hat}[1]{\widehat{#1}}\)</span> <span class="math inline">\(\renewcommand{\tilde}[1]{\widetilde{#1}}\)</span> <span class="math inline">\(\renewcommand{\theta}{\vartheta}\)</span></p>
<p>Gli <strong>esperimenti industriali</strong> spesso coinvolgono numerosi fattori corrispondenti a <strong>modelli con regressori multipli</strong> molto complessi</p>
<p>È quindi necessario <strong>minimizzare il numero di trattamenti</strong> e, quindi, il costo dell’esperimento, <strong>a parità di informazioni</strong> ottenute</p>
<p>Gli esperimenti devono poi essere analizzati con un approccio statistico</p>
</section>
<section id="esperimento-industriale-o-esperimento-scientifico" class="slide level2">
<h2>Esperimento industriale o esperimento scientifico?</h2>
<div class="columns">
<div class="column">
<p>Un <strong>esperimento scientifico</strong> viene generalmente condotto allo scopo di supportare o confutare una teoria</p>
<ul>
<li>è sempre basato su un <strong>modello teorico</strong> da verificare</li>
<li>spesso il modello si focalizza sull’effetto di un numero limitato di fattori</li>
</ul>
</div><div class="column">
<p>In <strong>campo industriale</strong> spesso ciò non è possibile:</p>
<ul>
<li>spesso un <strong>modello teorico</strong> per l’oggetto dell’esperimento non è disponibile per motivi scientifici, tecnici o pratici</li>
<li>l’<strong>interazione</strong> tra più fattori è spesso ciò che più interessa</li>
</ul>
</div></div>
<div class="fragment">
<p>Ai fini pratici, la <strong>progettazione</strong> dell’esperimento è tanto più importante quanto più è elevata la complessità (cioè il numero di fattori coinvolti)</p>
</div>
</section>
<section id="obiettivi-di-un-esperimento" class="slide level2">
<h2>Obiettivi di un esperimento</h2>
<p>In generale, un esperimento serve a:</p>
<ol type="1">
<li><strong>confermare</strong> un’ipotesi teorica (modello): si vuole verificare la <span class="bgreen">forma</span> <span class="math inline">\(y=f(\cdot)\)</span> del modello teorico; la regressione del modello è affiancata allo studio degli intervalli di confidenza (analitici o bootstrap)</li>
<li><strong>calibrare</strong> i parametri di un modello: la forma è nota e si vogliono ricavare i <span class="bgreen">valori dei parametri</span>; generalmente si effettua una regressione, raccogliendo i dati in condizioni operative realistiche</li>
<li><strong>identificare</strong> i fattori che influiscono su un processo: il modello può essere ignoto e si vuole determinare la <span class="bgreen">lista di fattori</span> che compaiono nella <span class="math inline">\(y=f(\cdot)\)</span>; l’obiettivo è costruire un modello empirico approssimato, eventualmente utilizzabile come punto di partenza per la formulazione di un modello teorico</li>
</ol>
</section>
<section id="dimensionalità-di-un-esperimento" class="slide level2">
<h2>Dimensionalità di un esperimento</h2>
<p>Se il <strong>modello di interesse è semplice</strong> (un regressore), l’esperimento consiste nell’analisi dell’uscita in corrispondenza di una sequenza di livelli per l’ingresso. Il numero di livelli è correlato con il grado atteso della risposta: per una regressione di grado <span class="math inline">\(l\)</span> servono <strong>almeno</strong> <span class="math inline">\(l+1\)</span> livelli</p>
<p>Ma se il modello è ha più di un regressore, cioè l’uscita dipende da <span class="math inline">\(n\)</span> fattori, e ogni fattore viene indagato su <span class="math inline">\(l\)</span> livelli, allora il numero di condizioni di test è <span class="math inline">\(l^n\)</span></p>
<p>Se ogni condizione di test viene poi ripetuta <span class="math inline">\(r\)</span> volte (per mediare i risultati), il numero di singoli esprimenti è <span class="math inline">\(rl^n\)</span></p>
<p>Questo numero può diventare grande e economicamente insostenibile <strong>molto in fretta</strong></p>

<aside><div>
<p>Supponiamo di avere 4 parametri e 4 livelli, ripetendo ogni test 3 volte: il numero totale di prove è 768; se i parametri diventano 5, il numero cresce a 3072, cioè 4 volte tanto, rapporto che vale <strong>anche per il costo</strong></p>
</div></aside></section></section>
<section>
<section id="piani-fattoriali" class="title-slide slide level1 center">
<h1>Piani fattoriali</h1>
<p>Se in un esperimento con un’unica variabile indipendente il fattore assume una <strong>sequenza</strong> di valori, in un esperimento con più variabili indipendenti gli <span class="math inline">\(n\)</span> fattori assumono una <strong>griglia</strong> <span class="math inline">\(n\)</span>-dimensionale di valori, detta <strong>piano fattoriale</strong></p>
</section>
<section id="piano-fattoriale" class="slide level2">
<h2>Piano fattoriale</h2>
<div class="columns">
<div class="column">
<ul>
<li>Due fattori, <span class="math inline">\(A\)</span> e <span class="math inline">\(B\)</span></li>
<li>Indaghiamo 2 livelli per ogni fattore indicato come <span class="math inline">\(X-\)</span> e <span class="math inline">\(X+\)</span></li>
<li>Cambiamo <strong>un livello alla volta</strong></li>
<li>Valutiamo ogni trattamento <strong>1 sola volta</strong></li>
<li>Valutiamo gli <strong>effetti</strong> di <span class="math inline">\(A\)</span> e <span class="math inline">\(B\)</span>: <span class="math display">\[
\begin{align}
A &amp;= 50 - 20 = 30\\
B &amp;= 30 - 20 = 10
\end{align}
\]</span></li>
</ul>
</div><div class="column">
<div class="cell">
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="6-DoE_files/figure-revealjs/unnamed-chunk-3-1.png" width="1500"></p>
</figure>
</div>
</div>
</div>
</div></div>
</section>
<section id="notazione-di-yates" class="slide level2">
<h2>Notazione di Yates</h2>
<p>Quando i livelli di tutti i fattori sono solo due, si può usare l’<strong>ordine di Yates</strong> per indicare le combinazioni di livelli:</p>
<ul>
<li>Fattori ed effetti dei fattori si indicano con lettere maiuscole</li>
<li>I trattamenti si indicano con combinazioni di lettere minuscole
<ul>
<li>lettera presente significa fattore a livello alto</li>
<li>lettera assente significa fattore a livello basso</li>
<li>se tutte le lettere sono assente si scrive <span class="math inline">\((1)\)</span></li>
</ul></li>
</ul>

<aside><div>
<p>Nell’esempio alla slide precedente, i trattamenti sono <span class="math inline">\((1), a, b\)</span></p>
</div></aside></section>
<section id="piano-fattoriale-1" class="slide level2">
<h2>Piano fattoriale</h2>
<div class="columns">
<div class="column">
<p>Modificando un fattore alla volta non si individuano le <strong>interazioni</strong></p>
<p>Si ha interazione quando l’<strong>effetto</strong> di un fattore dipende dal <strong>livello</strong> di un altro fattore</p>
<p>In questo secondo esempio misuriamo la risposta dei trattamenti <span class="math inline">\((1), a, b, ab\)</span></p>
<p>Possiamo stimare sia gli effetti di <span class="math inline">\(A\)</span> e <span class="math inline">\(B\)</span> che l’<strong>interazione</strong> <span class="math inline">\(AB\)</span>:</p>
<p><span class="math display">\[
\begin{align}
A &amp;= \frac{a+ab}{2} - \frac{(1) + b}{2} = 6\\
B &amp;= \frac{b+ab}{2} - \frac{(1) + a}{2} = -14 \\
AB &amp;= \frac{a+b}{2} - \frac{(1)+ab}{2} = -24
\end{align}
\]</span></p>
</div><div class="column">
<div class="cell">
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="6-DoE_files/figure-revealjs/unnamed-chunk-5-1.png" width="1500"></p>
</figure>
</div>
</div>
</div>
</div></div>
</section>
<section id="grafico-di-interazione" class="slide level2">
<h2>Grafico di interazione</h2>
<div class="columns">
<div class="column">
<p>Il concetto di interazione è ben illustrato dai <strong>grafici di interazione</strong></p>
<ul>
<li>Se i due segmenti sono <strong>paralleli</strong> non c’è interazione</li>
<li>Se i due segmenti sono <strong>incrociati</strong> o convergenti c’è interazione</li>
<li>È <strong>indifferente</strong> quale fattore è in ascissa e quale in serie</li>
</ul>
</div><div class="column">
<div class="panel-tabset">
<ul id="tabset-1" class="panel-tabset-tabby"><li><a data-tabby-default="" href="#tabset-1-1">Resa vs.&nbsp;A</a></li><li><a href="#tabset-1-2">Resa vs.&nbsp;B</a></li></ul>
<div class="tab-content">
<div id="tabset-1-1">
<div class="cell">
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="6-DoE_files/figure-revealjs/unnamed-chunk-6-1.png" width="1500"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-1-2">
<div class="cell">
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="6-DoE_files/figure-revealjs/unnamed-chunk-7-1.png" width="1500"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</div></div>
</section>
<section id="superficie-di-risposta" class="slide level2">
<h2>Superficie di risposta</h2>
<div class="columns">
<div class="column">
<p>I grafici di interazione non sono altro che <strong>proiezioni</strong> sull’asse di uno dei due fattori della <strong>superficie di risposta</strong></p>
<p>Si usano generalmente <strong>unità codificate</strong>, riscalando l’intervallo di ciascun fattore sull’intervallo <span class="math inline">\([-1,1]\)</span></p>
<p>In questo modo si ha la stessa sensibilità indipendentemente dall’intervallo della scala originale</p>
</div><div class="column">
<div class="cell">
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="6-DoE_files/figure-revealjs/unnamed-chunk-8-1.png" width="1500"></p>
</figure>
</div>
</div>
</div>
</div></div>
<p><strong>NOTA</strong>: né la superficie di risposta né i grafici di interazione dànno alcuna informazione sulla <strong>significatività statistica</strong> degli effetti</p>
</section>
<section id="piani-fattoriali-k2" class="slide level2">
<h2>Piani fattoriali <span class="math inline">\(k^2\)</span></h2>
<p>In generale, un esperimento in cui si abbiano 2 fattori ciascuno testato su <span class="math inline">\(k\)</span> livelli è un piano fattoriale <span class="math inline">\(k^2\)</span>, perché il <strong>numero totale di trattamenti</strong> è <span class="math inline">\(N=rk^2\)</span>, dove <span class="math inline">\(r\)</span> è il numero di ripetizioni per ciascun trattamento</p>
<p>Il <strong>modello statistico</strong> e il modello di regressione associati all’esperimento sono:</p>
<p><span class="math display">\[
y_{ijk} = \mu + \alpha_i + \beta_j + (\alpha\beta)_{ij} + \varepsilon_{ijk};\quad \hat y = \mu + \alpha x_1 + \beta x_2 + (\alpha\beta)x_1 x_2
\]</span> con <span class="math inline">\(x_1\)</span> e <span class="math inline">\(x_2\)</span> i valori dei due fattori in <strong>unità codificate</strong></p>
<p>Come tale, l’esperimento può essere studiato con un’ANOVA a due fattori (o <strong>ANOVA a due vie</strong>):</p>
<div class="columns">
<div class="column">
<p><span class="math display">\[
\textrm{A)}~\left\{
\begin{align}
H_0&amp;: \alpha_1 = \alpha_2 = \dots =\alpha_a = 0 \\
H_1&amp;: \alpha_i \ne 0\quad\textrm{per almeno un}~i
\end{align}
\right.
\]</span></p>
<p><span class="math display">\[
\textrm{B)}~\left\{
\begin{align}
H_0&amp;: \beta_1 = \beta_2 = \dots =\beta_b = 0 \\
H_1&amp;: \beta_j \ne 0\quad\textrm{per almeno un}~j
\end{align}
\right.
\]</span></p>
</div><div class="column">
<p><span class="math display">\[
\textrm{AB)}~\left\{
\begin{align}
H_0&amp;: (\alpha\beta)_{ij} =   0\quad \forall~(i,j) \\
H_1&amp;: (\alpha\beta)_{ij} \ne 0\quad \textrm{per almeno una}~(i,j)
\end{align}
\right.
\]</span></p>
</div></div>
</section>
<section id="piani-fattoriali-k2-1" class="slide level2">
<h2>Piani fattoriali <span class="math inline">\(k^2\)</span></h2>
<p>A queste coppie di ipotesi corrisponde una decomposizione della <strong>somma quadratica totale corretta</strong> <span class="math inline">\(SS_\mathrm{tot}=SS_A + SS_B + SS_{AB} + SS_E\)</span></p>
<p>La tabella ANOVA corrispondente è:</p>
<table class="caption-top">
<colgroup>
<col style="width: 13%">
<col style="width: 13%">
<col style="width: 13%">
<col style="width: 13%">
<col style="width: 13%">
<col style="width: 30%">
</colgroup>
<thead>
<tr class="header">
<th>Effetto</th>
<th><span class="math inline">\(\nu\)</span> (GdL)</th>
<th><span class="math inline">\(SS\)</span></th>
<th><span class="math inline">\(MS\)</span></th>
<th><span class="math inline">\(F_0\)</span></th>
<th><em>p</em>-value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>A</td>
<td><span class="math inline">\(a-1\)</span></td>
<td><span class="math inline">\(SS_A\)</span></td>
<td><span class="math inline">\(SS_A/\nu_A\)</span></td>
<td><span class="math inline">\(MS_A/MS_E\)</span></td>
<td><span class="math inline">\(\mathrm{CDF}^+(F_{0,A}, \nu_A, \nu_E)\)</span></td>
</tr>
<tr class="even">
<td>B</td>
<td><span class="math inline">\(b-1\)</span></td>
<td><span class="math inline">\(SS_B\)</span></td>
<td><span class="math inline">\(SS_B/\nu_B\)</span></td>
<td><span class="math inline">\(MS_B/MS_E\)</span></td>
<td><span class="math inline">\(\mathrm{CDF}^+(F_{0,B}, \nu_B, \nu_E)\)</span></td>
</tr>
<tr class="odd">
<td>AB</td>
<td><span class="math inline">\((a-1)(b-1)\)</span>)</td>
<td><span class="math inline">\(SS_{AB}\)</span></td>
<td><span class="math inline">\(SS_{AB}/\nu_{AB}\)</span></td>
<td><span class="math inline">\(MS_{AB}/MS_E\)</span></td>
<td><span class="math inline">\(\mathrm{CDF}^+(F_{0,AB}, \nu_{AB}, \nu_E)\)</span></td>
</tr>
<tr class="even">
<td>Errore</td>
<td><span class="math inline">\(ab(-1)\)</span></td>
<td><span class="math inline">\(SS_E\)</span></td>
<td><span class="math inline">\(SS_E/\nu_E\)</span></td>
<td>—</td>
<td>—</td>
</tr>
<tr class="odd">
<td>Totale</td>
<td><span class="math inline">\(abn-1\)</span></td>
<td><span class="math inline">\(SS_\mathrm{tot}\)</span></td>
<td><span class="math inline">\(SS_\mathrm{tot}/\nu_\mathrm{tot}\)</span></td>
<td>—</td>
<td>—</td>
</tr>
</tbody>
</table>
</section>
<section id="esempio" class="slide level2">
<h2>Esempio</h2>
<p>Vogliamo studiare l’effetto della velocità di taglio (fattore <span class="math inline">\(A\)</span>) e dell’angolo di spoglia (fattore <span class="math inline">\(B\)</span>) di un utensile di tornitura sulla vita utensile</p>
<p>I due fattori sono entrambi <strong>quantitativi</strong>; decidiamo di indagare tre livelli per ciascun fattore, ripetendo 2 volte ogni trattamento: piano fattoriale <span class="math inline">\(2\cdot 3^2\)</span></p>
<div class="columns">
<div class="column">
<ol type="1">
<li>preparazione della <strong>griglia di test</strong></li>
<li>casualizzazione della sequenza operativa</li>
<li>conduzione degli esperimenti e raccolta dati</li>
<li>formulazione e verifica del modello statistico</li>
<li>analisi della varianza (ANOVA)</li>
<li>creazione della superficie di risposta</li>
</ol>
<p>I punti 4 e 5 sono possibilmente iterati</p>
</div><div class="column" style="font-size: 70%">
<div class="cell">
<div class="cell-output-display">
<table class="caption-top">
<thead>
<tr class="header">
<th style="text-align: right;">StdOrder</th>
<th style="text-align: right;">Angolo</th>
<th style="text-align: right;">A</th>
<th style="text-align: right;">Velocità</th>
<th style="text-align: right;">B</th>
<th style="text-align: right;">Ripetizione</th>
<th style="text-align: left;">Vita</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">15</td>
<td style="text-align: right;">-1</td>
<td style="text-align: right;">125</td>
<td style="text-align: right;">-1</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">NA</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">20</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">125</td>
<td style="text-align: right;">-1</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3</td>
<td style="text-align: right;">25</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">125</td>
<td style="text-align: right;">-1</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">NA</td>
</tr>
<tr class="even">
<td style="text-align: right;">4</td>
<td style="text-align: right;">15</td>
<td style="text-align: right;">-1</td>
<td style="text-align: right;">150</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: right;">5</td>
<td style="text-align: right;">20</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">150</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">NA</td>
</tr>
<tr class="even">
<td style="text-align: right;">6</td>
<td style="text-align: right;">25</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">150</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: right;">7</td>
<td style="text-align: right;">15</td>
<td style="text-align: right;">-1</td>
<td style="text-align: right;">175</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">NA</td>
</tr>
<tr class="even">
<td style="text-align: right;">8</td>
<td style="text-align: right;">20</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">175</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: right;">9</td>
<td style="text-align: right;">25</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">175</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">NA</td>
</tr>
</tbody>
</table>
</div>
</div>
</div></div>

<aside><div>
<p>Per motivi di spazio la tabella riporta solo la prima metà delle righe, corrispondenti con la prima ripetizione</p>
</div></aside></section>
<section id="esempio-passo-2." class="slide level2">
<h2>Esempio — passo 2.</h2>
<div class="columns">
<div class="column">
<p>Nella griglia si genera una nuova colonna di interi <span class="math inline">\(\left&lt;1\dots N\right&gt;,~N=rl^n\)</span> ordinati casualmente</p>
<p>Si riordina la griglia secondo la nuova colonna, generalmente chiamata <em>Run Order</em></p>
</div><div class="column" style="font-size: 60%;">
<div class="cell">
<div class="cell-output-display">
<table class="caption-top">
<thead>
<tr class="header">
<th style="text-align: right;">StdOrder</th>
<th style="text-align: right;">RunOrder</th>
<th style="text-align: right;">Angolo</th>
<th style="text-align: right;">A</th>
<th style="text-align: right;">Velocità</th>
<th style="text-align: right;">B</th>
<th style="text-align: right;">Ripetizione</th>
<th style="text-align: left;">Vita</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">4</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">15</td>
<td style="text-align: right;">-1</td>
<td style="text-align: right;">150</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">NA</td>
</tr>
<tr class="even">
<td style="text-align: right;">5</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">20</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">150</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: right;">10</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">15</td>
<td style="text-align: right;">-1</td>
<td style="text-align: right;">125</td>
<td style="text-align: right;">-1</td>
<td style="text-align: right;">2</td>
<td style="text-align: left;">NA</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">20</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">125</td>
<td style="text-align: right;">-1</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: right;">12</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">25</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">125</td>
<td style="text-align: right;">-1</td>
<td style="text-align: right;">2</td>
<td style="text-align: left;">NA</td>
</tr>
<tr class="even">
<td style="text-align: right;">15</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">25</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">150</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">2</td>
<td style="text-align: left;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">25</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">125</td>
<td style="text-align: right;">-1</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">NA</td>
</tr>
<tr class="even">
<td style="text-align: right;">18</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">25</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">175</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
<td style="text-align: left;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: right;">17</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">20</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">175</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
<td style="text-align: left;">NA</td>
</tr>
<tr class="even">
<td style="text-align: right;">14</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">20</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">150</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">2</td>
<td style="text-align: left;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: right;">8</td>
<td style="text-align: right;">11</td>
<td style="text-align: right;">20</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">175</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">NA</td>
</tr>
<tr class="even">
<td style="text-align: right;">13</td>
<td style="text-align: right;">12</td>
<td style="text-align: right;">15</td>
<td style="text-align: right;">-1</td>
<td style="text-align: right;">150</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">2</td>
<td style="text-align: left;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: right;">6</td>
<td style="text-align: right;">13</td>
<td style="text-align: right;">25</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">150</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">NA</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">14</td>
<td style="text-align: right;">15</td>
<td style="text-align: right;">-1</td>
<td style="text-align: right;">125</td>
<td style="text-align: right;">-1</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: right;">11</td>
<td style="text-align: right;">15</td>
<td style="text-align: right;">20</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">125</td>
<td style="text-align: right;">-1</td>
<td style="text-align: right;">2</td>
<td style="text-align: left;">NA</td>
</tr>
<tr class="even">
<td style="text-align: right;">7</td>
<td style="text-align: right;">16</td>
<td style="text-align: right;">15</td>
<td style="text-align: right;">-1</td>
<td style="text-align: right;">175</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: right;">16</td>
<td style="text-align: right;">17</td>
<td style="text-align: right;">15</td>
<td style="text-align: right;">-1</td>
<td style="text-align: right;">175</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
<td style="text-align: left;">NA</td>
</tr>
<tr class="even">
<td style="text-align: right;">9</td>
<td style="text-align: right;">18</td>
<td style="text-align: right;">25</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">175</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">NA</td>
</tr>
</tbody>
</table>
</div>
</div>
</div></div>
</section>
<section id="esempio-passo-3." class="slide level2">
<h2>Esempio — passo 3.</h2>
<div class="columns">
<div class="column">
<p>Si effettuano gli esperimenti secondo il <em>run order</em></p>
<p>Eseguendo gli esperimenti secondo il <em>run order</em> eventuali effetti <strong>ignoti e incontrollati</strong> si distribuiscono casualmente su tutti i trattamenti:</p>
<ul>
<li>la varianza globale aumenta (<span class="math inline">\(SS_\mathrm{tot}\)</span>)</li>
<li>l’effetto relativo dei fattori non viene alterato (<span class="math inline">\(SS_X\)</span>)</li>
</ul>
<p><strong>Nota</strong>: una <em>ripetizione</em> è una replica dell’intero esperimento, non della sola operazione di misura</p>
</div><div class="column" style="font-size: 60%;">
<div class="cell">
<div class="cell-output-display">
<table class="caption-top">
<thead>
<tr class="header">
<th style="text-align: right;">StdOrder</th>
<th style="text-align: right;">RunOrder</th>
<th style="text-align: right;">Angolo</th>
<th style="text-align: right;">A</th>
<th style="text-align: right;">Velocità</th>
<th style="text-align: right;">B</th>
<th style="text-align: right;">Ripetizione</th>
<th style="text-align: right;">Vita</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">4</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">15</td>
<td style="text-align: right;">-1</td>
<td style="text-align: right;">150</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">-3</td>
</tr>
<tr class="even">
<td style="text-align: right;">5</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">20</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">150</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: right;">10</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">15</td>
<td style="text-align: right;">-1</td>
<td style="text-align: right;">125</td>
<td style="text-align: right;">-1</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">-1</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">20</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">125</td>
<td style="text-align: right;">-1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: right;">12</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">25</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">125</td>
<td style="text-align: right;">-1</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: right;">15</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">25</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">150</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">6</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">25</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">125</td>
<td style="text-align: right;">-1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">-1</td>
</tr>
<tr class="even">
<td style="text-align: right;">18</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">25</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">175</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">-1</td>
</tr>
<tr class="odd">
<td style="text-align: right;">17</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">20</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">175</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">6</td>
</tr>
<tr class="even">
<td style="text-align: right;">14</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">20</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">150</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">3</td>
</tr>
<tr class="odd">
<td style="text-align: right;">8</td>
<td style="text-align: right;">11</td>
<td style="text-align: right;">20</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">175</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="even">
<td style="text-align: right;">13</td>
<td style="text-align: right;">12</td>
<td style="text-align: right;">15</td>
<td style="text-align: right;">-1</td>
<td style="text-align: right;">150</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: right;">6</td>
<td style="text-align: right;">13</td>
<td style="text-align: right;">25</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">150</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">5</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">14</td>
<td style="text-align: right;">15</td>
<td style="text-align: right;">-1</td>
<td style="text-align: right;">125</td>
<td style="text-align: right;">-1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">-2</td>
</tr>
<tr class="odd">
<td style="text-align: right;">11</td>
<td style="text-align: right;">15</td>
<td style="text-align: right;">20</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">125</td>
<td style="text-align: right;">-1</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="even">
<td style="text-align: right;">7</td>
<td style="text-align: right;">16</td>
<td style="text-align: right;">15</td>
<td style="text-align: right;">-1</td>
<td style="text-align: right;">175</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="odd">
<td style="text-align: right;">16</td>
<td style="text-align: right;">17</td>
<td style="text-align: right;">15</td>
<td style="text-align: right;">-1</td>
<td style="text-align: right;">175</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">3</td>
</tr>
<tr class="even">
<td style="text-align: right;">9</td>
<td style="text-align: right;">18</td>
<td style="text-align: right;">25</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">175</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
</tr>
</tbody>
</table>
</div>
</div>
</div></div>
</section>
<section id="esempio-passo-4." class="slide level2">
<h2>Esempio — passo 4.</h2>
<div class="columns">
<div class="column">
<p>Formuliamo il modello di regressione completo di secondo grado:</p>
<p><span class="math display">\[\begin{align}
\hat y = &amp; \mu + \alpha_1 x_1 + \beta_1 x_2 + (\alpha\beta)_1x_1x_2 + \\
         &amp; + \alpha_2x_1^2 + \beta_2x_2^2 + (\alpha\beta)_{2,1}x_1^2x_2 + \\
         &amp; + (\alpha\beta)_{1,2}x_1x_2^2 + (\alpha\beta)_{2,2}x_1^2x_2^2
      
\end{align}\]</span></p>
<p>dove, ricordiamo <span class="math inline">\((\alpha\beta)\)</span> non è un prodotto, ma rappresenta il coefficiente di un prodotto di fattori <span class="math inline">\(A\)</span> e <span class="math inline">\(B\)</span></p>
<p><strong>È necessario valutare normalità e assenza di pattern nei residui</strong></p>
</div><div class="column">
<div class="panel-tabset">
<ul id="tabset-2" class="panel-tabset-tabby"><li><a data-tabby-default="" href="#tabset-2-1"><span class="math inline">\(\varepsilon(A)\)</span></a></li><li><a href="#tabset-2-2"><span class="math inline">\(\varepsilon(B)\)</span></a></li><li><a href="#tabset-2-3"><span class="math inline">\(\varepsilon(r)\)</span></a></li><li><a href="#tabset-2-4">Quantile-Quantile</a></li></ul>
<div class="tab-content">
<div id="tabset-2-1">
<div class="cell">
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="6-DoE_files/figure-revealjs/unnamed-chunk-13-1.png" width="1500"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-2-2">
<div class="cell">
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="6-DoE_files/figure-revealjs/unnamed-chunk-14-1.png" width="1500"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-2-3">
<div class="cell">
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="6-DoE_files/figure-revealjs/unnamed-chunk-15-1.png" width="1500"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-2-4">
<div class="cell">
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="6-DoE_files/figure-revealjs/unnamed-chunk-16-1.png" width="1500"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</div></div>
</section>
<section id="esempio-passo-5." class="slide level2">
<h2>Esempio — passo 5.</h2>
<div class="columns">
<div class="column">
<p>Scegliendo il 5% come soglia sul <em>p</em>-value, osserviamo che risultano <strong>statisticamente non significativi</strong> gli effetti:</p>
<ul>
<li><span class="math inline">\(B^2\)</span>, corrispondente al termine <span class="math inline">\(\beta_2\)</span> nella regressione</li>
<li><span class="math inline">\(A^2B\)</span>, corrispondente al termine <span class="math inline">\((\alpha\beta)_{2,1}\)</span> nella regressione</li>
</ul>
</div><div class="column" style="font-size: 65%;">
<div class="cell">
<div class="cell-output-display">
<table class="caption-top">
<colgroup>
<col style="width: 20%">
<col style="width: 8%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 27%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">effetto</th>
<th style="text-align: right;"><span class="math inline">\(\nu\)</span></th>
<th style="text-align: right;"><span class="math inline">\(SS\)</span></th>
<th style="text-align: right;"><span class="math inline">\(MS\)</span></th>
<th style="text-align: right;"><span class="math inline">\(F_0\)</span></th>
<th style="text-align: right;"><span class="math inline">\(p\mathrm{-value}\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(A\)</span></td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">8.333333</td>
<td style="text-align: right;">8.333333</td>
<td style="text-align: right;">5.769231</td>
<td style="text-align: right;">0.0397723</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(B\)</span></td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">21.333333</td>
<td style="text-align: right;">21.333333</td>
<td style="text-align: right;">14.769231</td>
<td style="text-align: right;">0.0039479</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(A^2\)</span></td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">16.000000</td>
<td style="text-align: right;">16.000000</td>
<td style="text-align: right;">11.076923</td>
<td style="text-align: right;">0.0088243</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(B^2\)</span></td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">4.000000</td>
<td style="text-align: right;">4.000000</td>
<td style="text-align: right;">2.769231</td>
<td style="text-align: right;">0.1304507</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(AB\)</span></td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">8.000000</td>
<td style="text-align: right;">8.000000</td>
<td style="text-align: right;">5.538462</td>
<td style="text-align: right;">0.0430650</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(A^2B\)</span></td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2.666667</td>
<td style="text-align: right;">2.666667</td>
<td style="text-align: right;">1.846154</td>
<td style="text-align: right;">0.2073056</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(AB^2\)</span></td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">42.666667</td>
<td style="text-align: right;">42.666667</td>
<td style="text-align: right;">29.538462</td>
<td style="text-align: right;">0.0004137</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(A^2B^2\)</span></td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">8.000000</td>
<td style="text-align: right;">8.000000</td>
<td style="text-align: right;">5.538462</td>
<td style="text-align: right;">0.0430650</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(\varepsilon\)</span></td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">13.000000</td>
<td style="text-align: right;">1.444444</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
</tbody>
</table>
</div>
</div>
</div></div>
<p>Quindi l’equazione di regressione diventa: <span class="math display">\[\begin{align}
\hat y = &amp; \mu + \alpha_1 x_1 + \beta_1 x_2 + (\alpha\beta)_1x_1x_2 + \\
         &amp;  + \alpha_2x_1^2 + (\alpha\beta)_{1,2}x_1x_2^2 + \\
         &amp;  + (\alpha\beta)_{2,2}x_1^2x_2^2
      
\end{align}\]</span></p>
</section>
<section id="esempio-passo-6." class="slide level2">
<h2>Esempio — passo 6.</h2>
<div class="columns">
<div class="column">
<p>La <strong>superficie di risposta</strong> consente di identificare punti e direzioni notevoli:</p>
<ul>
<li>Il punto S è un punto di sella, in cui il gradiente è nullo in qualsiasi direzione: punto stabile</li>
<li>Nel punto P, le direzioni tangenti all’isoipsa sono <strong>direzioni a resa costante</strong></li>
<li>Il punto M è un <strong>massimo</strong> della resa</li>
</ul>
</div><div class="column" style="font-size: 65%;">
<div class="cell">
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="6-DoE_files/figure-revealjs/unnamed-chunk-18-1.png" width="1500"></p>
</figure>
</div>
</div>
</div>
</div></div>

<aside><div>
<p>In generale, una superfifice di risposta è una <strong>iper-superficie</strong> in uno spazio <span class="math inline">\(n+1\)</span>-dimensionale, dove <span class="math inline">\(n\)</span> è il numero di fattori</p>
</div></aside></section>
<section id="analisi-di-adeguatezza-del-modello" class="slide level2">
<h2>Analisi di adeguatezza del modello</h2>
<p>Dopo aver eventualmente escluso alcuni effetti (ad esempio <span class="math inline">\(B^2\)</span> e <span class="math inline">\(A^2B\)</span>) è necessario:</p>
<ol type="1">
<li>riformulare il modello</li>
<li>analizzare i residui del nuovo modello</li>
<li>confermare con una nuova ANOVA</li>
</ol>
<p>In particolare, l’analisi dei residui è detta <strong>verifica di adeguatezza del modello</strong> (<em>Model Adequacy Check</em>, MAC) e consiste dipicamente in:</p>
<ul>
<li>verifica assenza di pattern nei residui in funzione dei fattori</li>
<li>verifica assenza di pattern nei residui in funzione dell’ordine di test</li>
<li>verifica di normalità dei residui (grafico Q-Q e test di Shapiro-Wilk)</li>
</ul>
</section>
<section id="piano-fattoriale-2n" class="slide level2">
<h2>Piano fattoriale <span class="math inline">\(2^n\)</span></h2>
<div class="columns">
<div class="column" style="width:60%;">
<p>I piani fattoriali in cui tutti i fattori hanno due livelli (basso e alto, -1 e +1 in unità codificate) sono di particolare interesse</p>
<ul>
<li>consentono di regredire modelli soltanto del primo grado</li>
<li>richiedono il minimo delle prove</li>
<li>consentono comunque di definire la sensibilità del processo ai vari fattori, <strong>escludendo i fattori non-significativi</strong></li>
<li>sono il punto di partenza di qualsiasi analisi di processi complessi</li>
</ul>
</div><div class="column" style="width:40%;">
<p><img data-src="images/facplan1.png" width="350"></p>
</div></div>
</section>
<section id="piano-fattoriale-2n-1" class="slide level2">
<h2>Piano fattoriale <span class="math inline">\(2^n\)</span></h2>
<div class="columns">
<div class="column">
<ul>
<li>Ogni fattore ha due livelli: basso e alto. In <strong>unità codificate</strong> valgono -1 e +1, indicati in breve come <strong>- e +</strong></li>
<li>I <strong>trattamenti</strong>, cioè combinazioni di livelli per gli <span class="math inline">\(n\)</span> fattori, sono indicati con la <strong>notazione di Yates</strong></li>
<li>la <strong>matrice di progetto</strong> si ottiene permutando tutti i fattori tra - e + con frequenze via via dimezzate</li>
<li>la matrice di progetto è ripetuta per le <span class="math inline">\(r\)</span> ripetizioni e riporta anche la colonna dell’<strong>ordine casuale di esecuzione</strong></li>
<li>la <strong>matrice degli effetti</strong> si ottiene aggiungendo le colonne per le interazioni, calcolate come prodotto dei segni relativi</li>
</ul>
</div><div class="column" style="font-size: 85%; text-align: center;">
<div class="panel-tabset">
<ul id="tabset-3" class="panel-tabset-tabby"><li><a data-tabby-default="" href="#tabset-3-1">Matrice di progetto</a></li><li><a href="#tabset-3-2">Matrice degli effetti</a></li></ul>
<div class="tab-content">
<div id="tabset-3-1">
<div class="cell">
<div class="cell-output-display">
<table class="caption-top">
<thead>
<tr class="header">
<th style="text-align: left;">trattamento</th>
<th style="text-align: center;">ripetizione</th>
<th style="text-align: center;">A</th>
<th style="text-align: center;">B</th>
<th style="text-align: center;">C</th>
<th style="text-align: center;">ordine</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(1)</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">-</td>
<td style="text-align: center;">-</td>
<td style="text-align: center;">-</td>
<td style="text-align: center;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">a</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">+</td>
<td style="text-align: center;">-</td>
<td style="text-align: center;">-</td>
<td style="text-align: center;">7</td>
</tr>
<tr class="odd">
<td style="text-align: left;">b</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">-</td>
<td style="text-align: center;">+</td>
<td style="text-align: center;">-</td>
<td style="text-align: center;">5</td>
</tr>
<tr class="even">
<td style="text-align: left;">ab</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">+</td>
<td style="text-align: center;">+</td>
<td style="text-align: center;">-</td>
<td style="text-align: center;">6</td>
</tr>
<tr class="odd">
<td style="text-align: left;">c</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">-</td>
<td style="text-align: center;">-</td>
<td style="text-align: center;">+</td>
<td style="text-align: center;">8</td>
</tr>
<tr class="even">
<td style="text-align: left;">ac</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">+</td>
<td style="text-align: center;">-</td>
<td style="text-align: center;">+</td>
<td style="text-align: center;">4</td>
</tr>
<tr class="odd">
<td style="text-align: left;">bc</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">-</td>
<td style="text-align: center;">+</td>
<td style="text-align: center;">+</td>
<td style="text-align: center;">2</td>
</tr>
<tr class="even">
<td style="text-align: left;">abc</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">+</td>
<td style="text-align: center;">+</td>
<td style="text-align: center;">+</td>
<td style="text-align: center;">3</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="tabset-3-2">
<div class="cell">
<div class="cell-output-display">
<table class="caption-top">
<thead>
<tr class="header">
<th style="text-align: left;">trattamento</th>
<th style="text-align: center;">I</th>
<th style="text-align: center;">A</th>
<th style="text-align: center;">B</th>
<th style="text-align: center;">AB</th>
<th style="text-align: center;">C</th>
<th style="text-align: center;">AC</th>
<th style="text-align: center;">BC</th>
<th style="text-align: center;">ABC</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(1)</td>
<td style="text-align: center;">+</td>
<td style="text-align: center;">-</td>
<td style="text-align: center;">-</td>
<td style="text-align: center;">+</td>
<td style="text-align: center;">-</td>
<td style="text-align: center;">+</td>
<td style="text-align: center;">+</td>
<td style="text-align: center;">-</td>
</tr>
<tr class="even">
<td style="text-align: left;">a</td>
<td style="text-align: center;">+</td>
<td style="text-align: center;">+</td>
<td style="text-align: center;">-</td>
<td style="text-align: center;">-</td>
<td style="text-align: center;">-</td>
<td style="text-align: center;">-</td>
<td style="text-align: center;">+</td>
<td style="text-align: center;">+</td>
</tr>
<tr class="odd">
<td style="text-align: left;">b</td>
<td style="text-align: center;">+</td>
<td style="text-align: center;">-</td>
<td style="text-align: center;">+</td>
<td style="text-align: center;">-</td>
<td style="text-align: center;">-</td>
<td style="text-align: center;">+</td>
<td style="text-align: center;">-</td>
<td style="text-align: center;">+</td>
</tr>
<tr class="even">
<td style="text-align: left;">ab</td>
<td style="text-align: center;">+</td>
<td style="text-align: center;">+</td>
<td style="text-align: center;">+</td>
<td style="text-align: center;">+</td>
<td style="text-align: center;">-</td>
<td style="text-align: center;">-</td>
<td style="text-align: center;">-</td>
<td style="text-align: center;">-</td>
</tr>
<tr class="odd">
<td style="text-align: left;">c</td>
<td style="text-align: center;">+</td>
<td style="text-align: center;">-</td>
<td style="text-align: center;">-</td>
<td style="text-align: center;">+</td>
<td style="text-align: center;">+</td>
<td style="text-align: center;">-</td>
<td style="text-align: center;">-</td>
<td style="text-align: center;">+</td>
</tr>
<tr class="even">
<td style="text-align: left;">ac</td>
<td style="text-align: center;">+</td>
<td style="text-align: center;">+</td>
<td style="text-align: center;">-</td>
<td style="text-align: center;">-</td>
<td style="text-align: center;">+</td>
<td style="text-align: center;">+</td>
<td style="text-align: center;">-</td>
<td style="text-align: center;">-</td>
</tr>
<tr class="odd">
<td style="text-align: left;">bc</td>
<td style="text-align: center;">+</td>
<td style="text-align: center;">-</td>
<td style="text-align: center;">+</td>
<td style="text-align: center;">-</td>
<td style="text-align: center;">+</td>
<td style="text-align: center;">-</td>
<td style="text-align: center;">+</td>
<td style="text-align: center;">-</td>
</tr>
<tr class="even">
<td style="text-align: left;">abc</td>
<td style="text-align: center;">+</td>
<td style="text-align: center;">+</td>
<td style="text-align: center;">+</td>
<td style="text-align: center;">+</td>
<td style="text-align: center;">+</td>
<td style="text-align: center;">+</td>
<td style="text-align: center;">+</td>
<td style="text-align: center;">+</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div></div>
</section>
<section id="piano-fattoriale-2n-2" class="slide level2">
<h2>Piano fattoriale <span class="math inline">\(2^n\)</span></h2>
<p>La matrice degli effetti contiene le informazioni per calcolare gli <strong>effetti</strong> e le somme quadratiche <span class="math inline">\(SS\)</span> che, a loro volta, servono per completare la tabella ANOVA</p>
<div class="columns">
<div class="column">
<p>Per gli effetti: <span class="math display">\[
\begin{align}
A &amp;= \frac{-(1)+a-b+ab}{2r} \\
B &amp;= \frac{-(1)-a+b+ab}{2r} \\
AB &amp;= \frac{+(1)-a-b+ab}{2r}
\end{align}
\]</span></p>
</div><div class="column">
<p>Per le somme quadratiche: <span class="math display">\[
\begin{align}
SS_A &amp;=&amp; \frac{(-(1)+a-b+ab)^2}{4r} \\
SS_B &amp;=&amp; \frac{(-(1)-a+b+ab)^2}{4r} \\
SS_{AB} &amp;=&amp; \frac{(+(1)-a-b+ab)^2}{4r}
\end{align}
\]</span></p>
</div></div>
<p>In generale: <span class="math inline">\(\mathrm{Ef}(X) = \frac{2}{2^nr}\mathrm{Contrast}(X)\)</span> e <span class="math inline">\(\mathit{SS}(X) = \frac{1}{2^nr}\mathrm{Contrast}(X)^2\)</span> dove il <strong>contrasto</strong> del fattore <span class="math inline">\(\mathrm{Contrast}(X)\)</span> è calcolato usando i segni della relativa colonna <span class="math inline">\(X\)</span> per i trattamenti nell’ordine di Yates (es. <span class="math inline">\(\mathrm{Contrast}(AB)=+(1)-a-b+ab\)</span>)</p>
</section>
<section id="piano-fattoriale-2n-modello-statistico" class="slide level2">
<h2>Piano fattoriale <span class="math inline">\(2^n\)</span>: modello statistico</h2>
<p>Il <strong>modello statistico</strong> di un piano fattoriale <span class="math inline">\(2^n\)</span> è ovviamente un modello lineare di primo grado in tutti i fattori. Per <span class="math inline">\(n=2\)</span>, ad esempio:</p>
<p><span class="math display">\[
y_{ijk} = \mu + \alpha_{i} + \beta_{j} + (\alpha\beta)_{ij}+\varepsilon_{ijk}
\]</span> Per <span class="math inline">\(n=3\)</span>: <span class="math display">\[
y_{ijkl} = \mu + \alpha_{i} + \beta_{j} + (\alpha\beta)_{ij}+ \gamma_k + (\alpha\gamma)_{ik} + (\beta\gamma)_{jk} + (\alpha\beta\gamma)_{ijk} + \varepsilon_{ijkl}
\]</span> e così via.</p>
<p>In R vedremo che questi modelli possono essere rispettivamente abbreviati come <code>Y~A*B</code> e <code>Y~A*B*C</code> e utilizzati per calcolare la tabella ANOVA</p>

<aside><div>
<p>Esercizio: ricavare i modelli di regressione corrispondenti ai due modelli statistici sopra riportati</p>
</div></aside></section>
<section id="piani-fattoriali-non-replicati" class="slide level2">
<h2>Piani fattoriali non replicati</h2>
<p>Al crescere del numero di fattori, il numero di singoli test può diventare insostenibile</p>
<p>Il modo più semplice per ridurre il numero di test è <strong>evitare le ripetizioni per i vari trattamenti</strong></p>
<p>Se un trattamento non è ripetuto, però, non è possibile calcolare la <span class="math inline">\(SS_E\)</span> e quindi non si può completare la tabella ANOVA con le <span class="math inline">\(F_0\)</span> e i <em>p</em>-value</p>
<p>La soluzione è stata proposta da C.&nbsp;Daniel e si basa sull’<strong>ipotesi che almeno uno dei fattori o delle interazioni <span style="text-decoration: underline;">non sia significativo</span></strong></p>
<p>Quest’ipotesi è di solito ragionevole per i processi più complessi con <span class="math inline">\(n\)</span> elevato, proprio i casi in cui è particolarmente importante ridurre il numero di test</p>
<p>L’idea è che gli <strong>effetti non-significativi</strong> siano statistiche calcolate su diversi sotto-campioni dello stesso campione omogeneo, e quindi siano normalmente distribuiti. Solo gli <strong>effetti significativi</strong> si dipartono dalla distribuzione normale degli altri</p>
</section>
<section id="metodo-di-daniel" class="slide level2">
<h2>Metodo di Daniel</h2>
<div class="columns">
<div class="column">
<p>Quali effetti siano probabilmente significativi è quindi possibile determinarlo con un grafico quantile-quantile degli stessi</p>
<p>Il grafico è un primo screening che deve essere <strong>conservativo</strong>: serve solo per rimuovere effetti sicuramente non significativi (cioè molto allineati alla diagonale) e consentire l’esecuzione dell’ANOVA</p>
<p>La tabella ANOVA va comunque calcolata su un <strong>modello statistico lineare ridotto</strong>, in modo da confermare il risultato del metodo grafico o da rimuovere ulteriori effetti che risultassero effettivamente non-significativi</p>
</div><div class="column">
<div class="cell">
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="6-DoE_files/figure-revealjs/unnamed-chunk-21-1.png" width="1500"></p>
</figure>
</div>
</div>
</div>
</div></div>
</section>
<section id="metodo-di-daniel-1" class="slide level2">
<h2>Metodo di Daniel</h2>
<div class="columns">
<div class="column">
<p>In questo caso risultano non-normali solo gli effetti <span class="math inline">\(A, C, D\)</span> e le interazioni <span class="math inline">\(AC\)</span> e <span class="math inline">\(AD\)</span></p>
<p>Il modello statistico lineare può quindi essere rivisto come</p>
<p><span class="math display">\[
\begin{multline}
y_{ijkl} = \mu + \alpha_{i} + \\
+ \gamma_{j} + (\alpha\gamma)_{ij}+ \delta_k + (\alpha\delta)_{ik} + \varepsilon_{ijkl}
\end{multline}
\]</span> Cioè possiamo già escludere che <span class="math inline">\(B\)</span> sia di fatto un fattore. In questo modo, anziché un piano fattoriale <span class="math inline">\(2^4\)</span> non replicato abbiamo a che fare con un <span class="math inline">\(2^3\)</span> replicato due volte (cioè <span class="math inline">\(2\cdot 2^3\)</span>), per il quale possiamo eseguire una normale analisi ANOVA</p>
</div><div class="column">
<div class="cell">
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="6-DoE_files/figure-revealjs/unnamed-chunk-22-1.png" width="1500"></p>
</figure>
</div>
</div>
</div>
</div></div>
</section></section>
<section>
<section id="trasformazioni" class="title-slide slide level1 center">
<h1>Trasformazioni</h1>
<p>In generale, se i residui di un modello lineare risultano non-normali, allora i <em>p</em>-value non possono essere calcolati a partire dalle <span class="math inline">\(F_0\)</span></p>
<p>Spesso, però, è possibile <strong>trasformare</strong> la risposta in modo da rendere normali i residui</p>
<p>La trasformazione può essere una qualunque funzione analitica applicata alla risposta</p>
</section>
<section id="esempio-1" class="slide level2">
<h2>Esempio</h2>
<div class="columns">
<div class="column">
<p>Consideriamo i dati rappresentati in questo grafico</p>
<p>Non ha importanza l’origine dei dati: limitiamoci a costruire un modello lineare dei dati</p>
<p><span class="math display">\[ y_{ij} = \mu + x_i + \varepsilon_{ij}\]</span></p>
<p>Si noti come i residui non sembrano normali e che ci sono degli evidenti <strong>pattern</strong></p>
</div><div class="column">
<div class="panel-tabset">
<ul id="tabset-4" class="panel-tabset-tabby"><li><a data-tabby-default="" href="#tabset-4-1">Dati</a></li><li><a href="#tabset-4-2">Residui vs.&nbsp;x</a></li><li><a href="#tabset-4-3">Residui vs.&nbsp;<span class="math inline">\(\hat y\)</span></a></li><li><a href="#tabset-4-4">Q-Q</a></li></ul>
<div class="tab-content">
<div id="tabset-4-1">
<div class="cell">
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="6-DoE_files/figure-revealjs/unnamed-chunk-24-1.png" width="1500"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-4-2">
<div class="cell">
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="6-DoE_files/figure-revealjs/unnamed-chunk-25-1.png" width="1500"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-4-3">
<div class="cell">
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="6-DoE_files/figure-revealjs/unnamed-chunk-26-1.png" width="1500"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-4-4">
<div class="cell">
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="6-DoE_files/figure-revealjs/unnamed-chunk-27-1.png" width="1500"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</div></div>
</section>
<section id="esempio-2" class="slide level2">
<h2>Esempio</h2>
<div class="columns">
<div class="column">
<p>Se osserviamo dal boxplot che la resa tende ad aumentare più che linearmente con <span class="math inline">\(x\)</span>, possiamo pensare di riformulare il modello <em>trasformandolo</em> mediante un’elevazione al quadrato:</p>
<p><span class="math display">\[ y_{ij} = (\mu + x_i + \varepsilon_{ij})^2\]</span> Il modello non sembra più lineare, ma considerando che può essere riscritto come</p>
<p><span class="math display">\[ \sqrt{y_{ij}} = \mu + x_i + \varepsilon_{ij}\]</span></p>
<p>è evidente che si tratta ancora di un <strong>modello lineare nei coefficienti</strong>.</p>
</div><div class="column">
<div class="panel-tabset">
<ul id="tabset-5" class="panel-tabset-tabby"><li><a data-tabby-default="" href="#tabset-5-1">Residui vs.&nbsp;x</a></li><li><a href="#tabset-5-2">Residui vs.&nbsp;<span class="math inline">\(\hat y\)</span></a></li><li><a href="#tabset-5-3">Q-Q</a></li></ul>
<div class="tab-content">
<div id="tabset-5-1">
<div class="cell">
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="6-DoE_files/figure-revealjs/unnamed-chunk-28-1.png" width="1500"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-5-2">
<div class="cell">
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="6-DoE_files/figure-revealjs/unnamed-chunk-29-1.png" width="1500"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-5-3">
<div class="cell">
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="6-DoE_files/figure-revealjs/unnamed-chunk-30-1.png" width="1500"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</div></div>

<aside><div>
<p>In seguito a questa trasformazione è quindi evidente che il nuovo modello è più adeguato, con residui privi di pattern e più compatibili con una distribuzione normale</p>
</div></aside></section>
<section id="trasformazioni-box-cox" class="slide level2">
<h2>Trasformazioni Box-Cox</h2>
<p>Box e Cox hanno proposto un metodo per identificare la <strong>miglior trasformazione</strong> nella famiglia delle trasformazioni di potenza <span class="math inline">\(y^* = y^\lambda\)</span>, con <span class="math inline">\(y^*=\ln(y)\)</span> quando <span class="math inline">\(\lambda=0\)</span></p>
<p>Si calcola un grafico della <strong>verosimiglianza logaritmica</strong> <span class="math inline">\(\mathcal{L}\)</span> (<em>log-likelyhood</em>) della seguente <span class="math inline">\(y^{(\lambda)}\)</span>:</p>
<p><span class="math display">\[
y_i^{(\lambda)} =
\begin{cases}
\frac{y_i^\lambda-1}{\lambda\dot y^{\lambda-1}} &amp; \lambda\neq 0 \\
\dot y \ln y_i &amp; \lambda = 0
\end{cases}, ~~~ \dot y = \exp\left[(1/n)\sum \ln y_i\right],~i=1, 2,\dots,n
\]</span> La verosimiglianza <span class="math inline">\(\ln\mathcal{L}(\lambda|y)\)</span> non è altro che la probabilità di estrarre un campione <span class="math inline">\(y\)</span> dato un certo parametro <span class="math inline">\(\lambda\)</span>. Il suo massimo coincide col valore di <span class="math inline">\(\lambda\)</span> che rende il campione <span class="math inline">\(y\)</span> più normale.</p>
</section>
<section id="diagramma-box-cox" class="slide level2">
<h2>Diagramma Box-Cox</h2>
<div class="columns">
<div class="column">
<p>Il diagramma Box-Cox individua anche un intervallo corrispondente ad una variazione inferiore al 95%</p>
<p>Qualunque valore di <span class="math inline">\(\lambda\)</span> interno a questo intervallo è statisticamente equivalente</p>
<p>Si sceglie quindi il valore includo nell’intervallo <strong>e che rappresenta una trasformazione “comoda”</strong></p>
<p>Ad es., se risultasse un <span class="math inline">\(\lambda\)</span> ottimale pari a 0.58, sceglierei comunque <span class="math inline">\(\lambda=0.5\)</span>, che corrisponde alla trasformazione <span class="math inline">\(y^*=\sqrt{y}\)</span></p>
</div><div class="column">
<div class="cell">
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="6-DoE_files/figure-revealjs/unnamed-chunk-31-1.png" width="1500"></p>
</figure>
</div>
</div>
</div>
</div></div>

<aside><div>
<p>Ogni volta che un modello lineare è <strong>sospetto</strong> (in una <strong>regressione</strong> o nell’<strong>analisi di un piano fattoriale</strong>) è opportuno tentare con una trasformazione Box-Cox. Nei PF, a volte la trasformazione Box-Cox può <strong>semplificare il modello</strong> (cioè ridurre il numero di fattori o interazioni significativi)</p>
</div></aside></section></section>
<section>
<section id="estensioni-e-frazionamenti" class="title-slide slide level1 center">
<h1>Estensioni e frazionamenti</h1>
<p>Un piano fattoriale <span class="math inline">\(2^n\)</span> assume che la risposta sia lineare: quest’ipotesi va verificata <strong>estendendo</strong> il piano a più di 2 livelli</p>
<p>Un piano fattoriale, anche <span class="math inline">\(2^n\)</span> non replicato, può risultare comunque troppo oneroso: in questi casi è possibile <strong>frazionarlo</strong>, cioè dividere per potenze di 2 il numero di trattamenti, pena la perdita di informazioni sulle interazioni più complesse</p>
</section>
<section id="central-composite-design-ccd" class="slide level2">
<h2>Central Composite Design (CCD)</h2>
<div class="columns">
<div class="column">
<p>Verrebbe automatico <strong>estendere</strong> un PF da <span class="math inline">\(2^2\)</span> a <span class="math inline">\(2^3\)</span> per valutare gli effetti quadratici</p>
<p>In questo modo, però, la <strong>sensibilità</strong> nelle direzioni assiali sarebbe inferiore alla sensibilità nelle direzioni diagonali, essendo l’intervallo di valutazione più piccolo nel primo caso</p>
<p>Si preferisce quindi eseguire PF centrati con <strong>simmetria rotazionale attorno all’origine</strong></p>
<p>Per due fattori, i punti assiali sono estesi a distanza <span class="math inline">\(\sqrt{2}\)</span> dall’origine; nel generico caso <span class="math inline">\(n\)</span>-dimensionale la distanza è <span class="math inline">\((2^n)^{1/4}\)</span></p>
</div><div class="column" style="text-align: center;">
<div class="panel-tabset">
<ul id="tabset-6" class="panel-tabset-tabby"><li><a data-tabby-default="" href="#tabset-6-1">Due fattori</a></li><li><a href="#tabset-6-2">Tre fattori</a></li></ul>
<div class="tab-content">
<div id="tabset-6-1">
<p><img data-src="images/CCD2.png"></p>
</div>
<div id="tabset-6-2">
<p><img data-src="images/CCD3.png"></p>
</div>
</div>
</div>
</div></div>
</section>
<section id="piani-fattoriali-frazionati-ffp" class="slide level2">
<h2>Piani fattoriali frazionati (FFP)</h2>
<div class="columns">
<div class="column">
<p>Supponiamo di considerare <strong>soltanto</strong> i vertici opposti del PF in figura: <span class="math inline">\((1), ab, ac, bc\)</span></p>
<p>Stiamo considerando <strong>metà del PF originale</strong>, che comunque include tutti i livelli dei tre fattori</p>
<p>Sicuramente il frazionamento riduce la completezza del modello, ma consente di risparmiare molti test</p>
<ul>
<li>Come scegliere il frazionamento per dimensioni superiori?</li>
<li>Quali informazioni perdiamo?</li>
</ul>
</div><div class="column" style="text-align: center;">
<p><img data-src="images/facplan1.png" width="350"></p>
</div></div>
</section>
<section id="scegliere-il-frazionamento-relazioni-definenti" class="slide level2">
<h2>Scegliere il frazionamento: relazioni definenti</h2>
<div class="columns">
<div class="column">
<p>Osservando la <strong>matrice degli effetti</strong>, osserviamo che i trattamenti <span class="math inline">\((1), ab, ac, bc\)</span> corrispondono alle righe per cui vale la relazione <span class="math inline">\(I=-ABC\)</span>. L’altra metà complementare corrisponde invece a <span class="math inline">\(I=ABC\)</span></p>
<p>Queste relazioni sono chiamate <strong>relazioni definenti</strong> perché definiscono il PFF. È indifferente scegliere la metà positiva o quella negativa</p>
</div><div class="column" style="font-size: 85%; text-align: center;">
<div class="cell">
<div class="cell-output-display">
<table class="caption-top">
<thead>
<tr class="header">
<th style="text-align: left;">trattamento</th>
<th style="text-align: center;">I</th>
<th style="text-align: center;">A</th>
<th style="text-align: center;">B</th>
<th style="text-align: center;">AB</th>
<th style="text-align: center;">C</th>
<th style="text-align: center;">AC</th>
<th style="text-align: center;">BC</th>
<th style="text-align: center;">ABC</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(1)</td>
<td style="text-align: center;">+</td>
<td style="text-align: center;">-</td>
<td style="text-align: center;">-</td>
<td style="text-align: center;">+</td>
<td style="text-align: center;">-</td>
<td style="text-align: center;">+</td>
<td style="text-align: center;">+</td>
<td style="text-align: center;">-</td>
</tr>
<tr class="even">
<td style="text-align: left;">a</td>
<td style="text-align: center;">+</td>
<td style="text-align: center;">+</td>
<td style="text-align: center;">-</td>
<td style="text-align: center;">-</td>
<td style="text-align: center;">-</td>
<td style="text-align: center;">-</td>
<td style="text-align: center;">+</td>
<td style="text-align: center;">+</td>
</tr>
<tr class="odd">
<td style="text-align: left;">b</td>
<td style="text-align: center;">+</td>
<td style="text-align: center;">-</td>
<td style="text-align: center;">+</td>
<td style="text-align: center;">-</td>
<td style="text-align: center;">-</td>
<td style="text-align: center;">+</td>
<td style="text-align: center;">-</td>
<td style="text-align: center;">+</td>
</tr>
<tr class="even">
<td style="text-align: left;">ab</td>
<td style="text-align: center;">+</td>
<td style="text-align: center;">+</td>
<td style="text-align: center;">+</td>
<td style="text-align: center;">+</td>
<td style="text-align: center;">-</td>
<td style="text-align: center;">-</td>
<td style="text-align: center;">-</td>
<td style="text-align: center;">-</td>
</tr>
<tr class="odd">
<td style="text-align: left;">c</td>
<td style="text-align: center;">+</td>
<td style="text-align: center;">-</td>
<td style="text-align: center;">-</td>
<td style="text-align: center;">+</td>
<td style="text-align: center;">+</td>
<td style="text-align: center;">-</td>
<td style="text-align: center;">-</td>
<td style="text-align: center;">+</td>
</tr>
<tr class="even">
<td style="text-align: left;">ac</td>
<td style="text-align: center;">+</td>
<td style="text-align: center;">+</td>
<td style="text-align: center;">-</td>
<td style="text-align: center;">-</td>
<td style="text-align: center;">+</td>
<td style="text-align: center;">+</td>
<td style="text-align: center;">-</td>
<td style="text-align: center;">-</td>
</tr>
<tr class="odd">
<td style="text-align: left;">bc</td>
<td style="text-align: center;">+</td>
<td style="text-align: center;">-</td>
<td style="text-align: center;">+</td>
<td style="text-align: center;">-</td>
<td style="text-align: center;">+</td>
<td style="text-align: center;">-</td>
<td style="text-align: center;">+</td>
<td style="text-align: center;">-</td>
</tr>
<tr class="even">
<td style="text-align: left;">abc</td>
<td style="text-align: center;">+</td>
<td style="text-align: center;">+</td>
<td style="text-align: center;">+</td>
<td style="text-align: center;">+</td>
<td style="text-align: center;">+</td>
<td style="text-align: center;">+</td>
<td style="text-align: center;">+</td>
<td style="text-align: center;">+</td>
</tr>
</tbody>
</table>
</div>
</div>
</div></div>

<aside><div>
<p>La matrice degli effetti per un PF frazionato <span class="math inline">\(2^{n-1}\)</span> più la relazione definente individuano univocamente un piano fattoriale frazionato</p>
</div></aside></section>
<section id="alias-e-informazioni-perdute" class="slide level2">
<h2><em>Alias</em> e informazioni perdute</h2>
<p>In un PF frazionato <span class="math inline">\(2^{3-1}\)</span> con relazione definente <span class="math inline">\(I=ABC\)</span>, consideriamo questi effetti: <span class="math display">\[
\begin{align}
A  &amp;= (-(1)+a-b+ab-c+ac-bc+abc)/(2r) \\
BC &amp;= (\underline{+(1)}+a-b\underline{-ab}-c\underline{-ac} \underline{+bc}+abc)/(2r)
\end{align}
\]</span> Siccome i trattamenti sottolineati <strong>non sono testati</strong>, l’effetto <span class="math inline">\(A\)</span> risulta indistinguibile dall’effetto <span class="math inline">\(BC\)</span></p>
<p>Si dice che <span class="math inline">\(A\)</span> <strong>è in <em>alias</em></strong> con <span class="math inline">\(BC\)</span></p>
<p>Data una certa relazione definente, le possibili strutture di alias possono essere ricavate dalla relazione stessa mediante un’<strong>algebra</strong> dedicata: <span class="math inline">\(I\cdot X=X\)</span>, <span class="math inline">\(X\cdot X = X\)</span>, <span class="math inline">\(X\cdot Y=XY\)</span>.</p>
<p>Quindi, risulta <span class="math inline">\(A\cdot I=A\cdot ABC\)</span> cioè <span class="math inline">\(A=BC\)</span>, e altrettanto <span class="math inline">\(B=AC\)</span> e <span class="math inline">\(C=AB\)</span>.</p>
</section>
<section id="alias-e-informazioni-perdute-1" class="slide level2">
<h2><em>Alias</em> e informazioni perdute</h2>
<p>Quindi, frazionando un PF si perdono informazioni: si perde la capacità di discriminare tra gli effetti in <em>alias</em>. È evidente che più lunga è la relazione definente, più elevato sarà il grado di interazioni in alias con gli effetti diretti (es. <span class="math inline">\(A=BCDEF\)</span>)</p>
<p>In virtù del <strong>principio di sparsità degli effetti</strong>, tuttavia, questa perdita di informazioni non è drammatica. Il <strong>principio</strong> dice che in un processo la significatività di interazioni di alto livello è via via meno probabile all’aumentare del numro di fattori che le compongono</p>
<p>Di conseguenza, un alias <span class="math inline">\(A=BCDEF\)</span> può essere trascurato assumendo la significatività di <span class="math inline">\(A\)</span> piuttosto che quella di <span class="math inline">\(BCDEF\)</span> in virtù del PSdE</p>
</section>
<section id="pf-frazionati-di-tipo-2n-p" class="slide level2">
<h2>PF Frazionati di tipo <span class="math inline">\(2^{n-p}\)</span></h2>
<p>È possibile frazionare un piano più di una volta, riducendo il numero di trattamenti a <span class="math inline">\(2^{n-p}\)</span></p>
<p>Per ogni frazionamento è necessario scegliere una nuova relazione definente</p>
<p>Ad esempio, per <span class="math inline">\(2^{7-2}\)</span> si possono scegliere le RD <span class="math inline">\(I=ABCDE\)</span> e <span class="math inline">\(I=CDEFG\)</span></p>
<p>Per queste due RD ne esiste una terza, dipendente: <span class="math inline">\(I=ABFG\)</span>. Due qualsiasi di queste tre RD sono equivalenti</p>
<h3 id="minimum-aberration-design">Minimum aberration design</h3>
<ul>
<li>Si generano tutte le possibili <span class="math inline">\(p\)</span>-uple di relazioni definenti, completandole con la dipendente</li>
<li>Si conta il numero di lettere nelle <span class="math inline">\((p+1)\)</span>-uple (es. precedente: <span class="math inline">\(\left&lt;5,5,4\right&gt;\)</span>)</li>
<li>il <em>design</em> che minimizza il numero di stringhe con lunghezza minima è da preferire perché <strong>ha meno alias</strong></li>
</ul>
</section></section>
<section>
<section id="raccomandazioni-finali" class="title-slide slide level1 center">
<h1>Raccomandazioni finali</h1>
<p>È molto comune assistere a DoE applicati solo parzialmente…</p>
</section>
<section id="per-fare-un-buon-pf" class="slide level2">
<h2>Per fare un buon PF</h2>
<ul>
<li>Iniziare con un <span class="math inline">\(2^n\)</span> per poi aumentarlo</li>
<li>Valutare l’opportunità di frazionamento e scegliere con attenzione le relazioni definenti</li>
<li>Eseguire <strong>sempre</strong> la verifica di adeguatezza del modello e raffinare il modello statistico di conseguenza</li>
<li>Discutere le interazione e gli effetti <strong>solo dopo aver raffinato il modello</strong></li>
<li>Valutare gli effetti di <em>alias</em></li>
</ul>
<h3 id="temi-avanzati">Temi avanzati</h3>
<ul>
<li><em>Blocking</em></li>
<li><em>Minimum Aberration Design</em></li>
<li>Trasformazioni del modello e trasformazioni Box-Cox</li>
</ul>


</section></section>
    </div>
  <div class="quarto-auto-generated-content" style="display: none;">
<div class="footer footer-default">
<p>paolo.bosetti@unitn.it — <a href="https://paolobosetti.quarto.pub/ADAS">https://paolobosetti.quarto.pub/ADAS</a></p>
</div>
</div></div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="../../site_libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="../../site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="../../site_libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="../../site_libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="../../site_libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="../../site_libs/revealjs/plugin/reveal-chalkboard/plugin.js"></script>
  <script src="../../site_libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="../../site_libs/revealjs/plugin/notes/notes.js"></script>
  <script src="../../site_libs/revealjs/plugin/search/search.js"></script>
  <script src="../../site_libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="../../site_libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': true,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'jumpToSlide': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleScrollView(event)\"><kbd>r</kbd> Scroll View Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"5\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleChalkboard(event)\"><kbd>b</kbd> Toggle Chalkboard</a></li>\n<li class=\"slide-tool-item\" data-item=\"6\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleNotesCanvas(event)\"><kbd>c</kbd> Toggle Notes Canvas</a></li>\n<li class=\"slide-tool-item\" data-item=\"7\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.downloadDrawings(event)\"><kbd>d</kbd> Download Drawings</a></li>\n<li class=\"slide-tool-item\" data-item=\"8\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'chalkboard': {"buttons":true},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: 'c/t',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'none',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1280,

        height: 720,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, RevealChalkboard, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    
    <script>
      // htmlwidgets need to know to resize themselves when slides are shown/hidden.
      // Fire the "slideenter" event (handled by htmlwidgets.js) when the current
      // slide changes (different for each slide format).
      (function () {
        // dispatch for htmlwidgets
        function fireSlideEnter() {
          const event = window.document.createEvent("Event");
          event.initEvent("slideenter", true, true);
          window.document.dispatchEvent(event);
        }

        function fireSlideChanged(previousSlide, currentSlide) {
          fireSlideEnter();

          // dispatch for shiny
          if (window.jQuery) {
            if (previousSlide) {
              window.jQuery(previousSlide).trigger("hidden");
            }
            if (currentSlide) {
              window.jQuery(currentSlide).trigger("shown");
            }
          }
        }

        // hookup for slidy
        if (window.w3c_slidy) {
          window.w3c_slidy.add_observer(function (slide_num) {
            // slide_num starts at position 1
            fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);
          });
        }

      })();
    </script>

    <script id="quarto-html-after-body" type="application/javascript">
    window.document.addEventListener("DOMContentLoaded", function (event) {
      const toggleBodyColorMode = (bsSheetEl) => {
        const mode = bsSheetEl.getAttribute("data-mode");
        const bodyEl = window.document.querySelector("body");
        if (mode === "dark") {
          bodyEl.classList.add("quarto-dark");
          bodyEl.classList.remove("quarto-light");
        } else {
          bodyEl.classList.add("quarto-light");
          bodyEl.classList.remove("quarto-dark");
        }
      }
      const toggleBodyColorPrimary = () => {
        const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
        if (bsSheetEl) {
          toggleBodyColorMode(bsSheetEl);
        }
      }
      toggleBodyColorPrimary();  
      const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
      tabsets.forEach(function(tabset) {
        const tabby = new Tabby('#' + tabset.id);
      });
      const isCodeAnnotation = (el) => {
        for (const clz of el.classList) {
          if (clz.startsWith('code-annotation-')) {                     
            return true;
          }
        }
        return false;
      }
      const onCopySuccess = function(e) {
        // button target
        const button = e.trigger;
        // don't keep focus
        button.blur();
        // flash "checked"
        button.classList.add('code-copy-button-checked');
        var currentTitle = button.getAttribute("title");
        button.setAttribute("title", "Copiato!");
        let tooltip;
        if (window.bootstrap) {
          button.setAttribute("data-bs-toggle", "tooltip");
          button.setAttribute("data-bs-placement", "left");
          button.setAttribute("data-bs-title", "Copiato!");
          tooltip = new bootstrap.Tooltip(button, 
            { trigger: "manual", 
              customClass: "code-copy-button-tooltip",
              offset: [0, -8]});
          tooltip.show();    
        }
        setTimeout(function() {
          if (tooltip) {
            tooltip.hide();
            button.removeAttribute("data-bs-title");
            button.removeAttribute("data-bs-toggle");
            button.removeAttribute("data-bs-placement");
          }
          button.setAttribute("title", currentTitle);
          button.classList.remove('code-copy-button-checked');
        }, 1000);
        // clear code selection
        e.clearSelection();
      }
      const getTextToCopy = function(trigger) {
          const codeEl = trigger.previousElementSibling.cloneNode(true);
          for (const childEl of codeEl.children) {
            if (isCodeAnnotation(childEl)) {
              childEl.remove();
            }
          }
          return codeEl.innerText;
      }
      const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
        text: getTextToCopy
      });
      clipboard.on('success', onCopySuccess);
      if (window.document.getElementById('quarto-embedded-source-code-modal')) {
        const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
          text: getTextToCopy,
          container: window.document.getElementById('quarto-embedded-source-code-modal')
        });
        clipboardModal.on('success', onCopySuccess);
      }
        var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
        var mailtoRegex = new RegExp(/^mailto:/);
          var filterRegex = new RegExp('/' + window.location.host + '/');
        var isInternal = (href) => {
            return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
        }
        // Inspect non-navigation links and adorn them if external
     	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
        for (var i=0; i<links.length; i++) {
          const link = links[i];
          if (!isInternal(link.href)) {
            // undo the damage that might have been done by quarto-nav.js in the case of
            // links that we want to consider external
            if (link.dataset.originalHref !== undefined) {
              link.href = link.dataset.originalHref;
            }
          }
        }
      function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
        const config = {
          allowHTML: true,
          maxWidth: 500,
          delay: 100,
          arrow: false,
          appendTo: function(el) {
              return el.closest('section.slide') || el.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start',
        };
        if (contentFn) {
          config.content = contentFn;
        }
        if (onTriggerFn) {
          config.onTrigger = onTriggerFn;
        }
        if (onUntriggerFn) {
          config.onUntrigger = onUntriggerFn;
        }
          config['offset'] = [0,0];
          config['maxWidth'] = 700;
        window.tippy(el, config); 
      }
      const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
      for (var i=0; i<noterefs.length; i++) {
        const ref = noterefs[i];
        tippyHover(ref, function() {
          // use id or data attribute instead here
          let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
          try { href = new URL(href).hash; } catch {}
          const id = href.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note) {
            return note.innerHTML;
          } else {
            return "";
          }
        });
      }
          let selectedAnnoteEl;
          const selectorForAnnotation = ( cell, annotation) => {
            let cellAttr = 'data-code-cell="' + cell + '"';
            let lineAttr = 'data-code-annotation="' +  annotation + '"';
            const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
            return selector;
          }
          const selectCodeLines = (annoteEl) => {
            const doc = window.document;
            const targetCell = annoteEl.getAttribute("data-target-cell");
            const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
            const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
            const lines = annoteSpan.getAttribute("data-code-lines").split(",");
            const lineIds = lines.map((line) => {
              return targetCell + "-" + line;
            })
            let top = null;
            let height = null;
            let parent = null;
            if (lineIds.length > 0) {
                //compute the position of the single el (top and bottom and make a div)
                const el = window.document.getElementById(lineIds[0]);
                top = el.offsetTop;
                height = el.offsetHeight;
                parent = el.parentElement.parentElement;
              if (lineIds.length > 1) {
                const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
                const bottom = lastEl.offsetTop + lastEl.offsetHeight;
                height = bottom - top;
              }
              if (top !== null && height !== null && parent !== null) {
                // cook up a div (if necessary) and position it 
                let div = window.document.getElementById("code-annotation-line-highlight");
                if (div === null) {
                  div = window.document.createElement("div");
                  div.setAttribute("id", "code-annotation-line-highlight");
                  div.style.position = 'absolute';
                  parent.appendChild(div);
                }
                div.style.top = top - 2 + "px";
                div.style.height = height + 4 + "px";
                div.style.left = 0;
                let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
                if (gutterDiv === null) {
                  gutterDiv = window.document.createElement("div");
                  gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                  gutterDiv.style.position = 'absolute';
                  const codeCell = window.document.getElementById(targetCell);
                  const gutter = codeCell.querySelector('.code-annotation-gutter');
                  gutter.appendChild(gutterDiv);
                }
                gutterDiv.style.top = top - 2 + "px";
                gutterDiv.style.height = height + 4 + "px";
              }
              selectedAnnoteEl = annoteEl;
            }
          };
          const unselectCodeLines = () => {
            const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
            elementsIds.forEach((elId) => {
              const div = window.document.getElementById(elId);
              if (div) {
                div.remove();
              }
            });
            selectedAnnoteEl = undefined;
          };
            // Handle positioning of the toggle
        window.addEventListener(
          "resize",
          throttle(() => {
            elRect = undefined;
            if (selectedAnnoteEl) {
              selectCodeLines(selectedAnnoteEl);
            }
          }, 10)
        );
        function throttle(fn, ms) {
        let throttle = false;
        let timer;
          return (...args) => {
            if(!throttle) { // first call gets through
                fn.apply(this, args);
                throttle = true;
            } else { // all the others get throttled
                if(timer) clearTimeout(timer); // cancel #2
                timer = setTimeout(() => {
                  fn.apply(this, args);
                  timer = throttle = false;
                }, ms);
            }
          };
        }
          // Attach click handler to the DT
          const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
          for (const annoteDlNode of annoteDls) {
            annoteDlNode.addEventListener('click', (event) => {
              const clickedEl = event.target;
              if (clickedEl !== selectedAnnoteEl) {
                unselectCodeLines();
                const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
                if (activeEl) {
                  activeEl.classList.remove('code-annotation-active');
                }
                selectCodeLines(clickedEl);
                clickedEl.classList.add('code-annotation-active');
              } else {
                // Unselect the line
                unselectCodeLines();
                clickedEl.classList.remove('code-annotation-active');
              }
            });
          }
      const findCites = (el) => {
        const parentEl = el.parentElement;
        if (parentEl) {
          const cites = parentEl.dataset.cites;
          if (cites) {
            return {
              el,
              cites: cites.split(' ')
            };
          } else {
            return findCites(el.parentElement)
          }
        } else {
          return undefined;
        }
      };
      var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
      for (var i=0; i<bibliorefs.length; i++) {
        const ref = bibliorefs[i];
        const citeInfo = findCites(ref);
        if (citeInfo) {
          tippyHover(citeInfo.el, function() {
            var popup = window.document.createElement('div');
            citeInfo.cites.forEach(function(cite) {
              var citeDiv = window.document.createElement('div');
              citeDiv.classList.add('hanging-indent');
              citeDiv.classList.add('csl-entry');
              var biblioDiv = window.document.getElementById('ref-' + cite);
              if (biblioDiv) {
                citeDiv.innerHTML = biblioDiv.innerHTML;
              }
              popup.appendChild(citeDiv);
            });
            return popup.innerHTML;
          });
        }
      }
    });
    </script>
    

</body></html>